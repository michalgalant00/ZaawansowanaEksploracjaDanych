---
title: "CountryData summary"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source_code: embed
runtime: shiny
---

```{r setup, include=FALSE}
library(ggplot2)
library(plotly)
library(plyr)
library(dplyr)
library(flexdashboard)

myFile = "./france.RData"

countryData = readRDS(myFile)

# Wybierz dane dla lat 1880 i 1980 oraz dla kobiet i mężczyzn
subset_data = subset(countryData, year %in% c(1880, 1980) & sex %in% c("Male", "Female"))
```


France data
=======================================================================

Column
-----------------------------------------------------------------------

### Rozkład wag dla lat 1880 i 1980

```{r}

p = ggplot(subset_data, aes(x = weight, fill = factor(year))) +
  geom_dotplot(binaxis = "y", stackdir = "center", alpha = 0.5) +
  labs(x = "Waga",
       y = "Gęstość") +
  facet_wrap(~sex)

p

```

### Rozkład wzrostu dla lat 1880 i 1980

```{r}

p = ggplot(subset_data, aes(x = height, fill = factor(year))) +
  geom_dotplot(binaxis = "y", stackdir = "center", alpha = 0.5) +
  labs(x = "Wzrost",
       y = "Gęstość") +
  facet_wrap(~sex)

p

```

Column
-----------------------------------------------------------------------

### Rozkład BMI dla lat 1880 i 1980

```{r}

p = ggplot(subset_data, aes(x = bmi, fill = factor(year))) +
  geom_density(alpha = 0.5) +
  labs(x = "BMI",
       y = "Gęstość") +
  facet_wrap(~sex)

p

```

### Porównanie średniej wagi między latami 1880 i 1980

```{r}

p = ggplot(subset_data, aes(x = factor(year), y = weight, fill = factor(year))) +
  geom_boxplot() +
  labs(x = "Rok",
       y = "Waga") +
  facet_wrap(~sex)

p

```

